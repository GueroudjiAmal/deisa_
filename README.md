# PDI Deisa Plugin

## Requirements 

_**DEISA**_ as a PDI plugin requires the [PDI Data Interface](https://pdi.dev/master/) to be installed with python support.
_**DEISA**_ requires Dask and [Dask Distributed deisa verion](https://github.com/GueroudjiAmal/distributed) that has been adapted to work with the new introduced concepts in _**DEISA**_ 

## Installation 

Check [here](https://github.com/pdidev/spack#deisa) for spack installation.

Or it can be  installed on top of pdi with :

```
  cmake -DCMAKE_INSTALL_PREFIX=$HOME/local/  -DPython3_EXECUTABLE=~/.conda/envs/yourenv/bin/python3.8  ../
  make install
```

## How it works ?

_**DEISA**_ is a library that ensures coupling MPI simulation codes with Dask analytics. 
**_DEISA_** plugin is built on [PDI Data Interface](https://pdi.dev/master/).

A simulation can be instrumented in PDI to make its internal data available for **_DEISA_**. The plugin retrieves it, creates corresponding keys, and sends it to Dask workers. 

Internally, a **_DEISA Bridge_** is created per MPI process. Once a piece of data is shared with PDI, the Bridge sends it to a worker that has been chosen in a round-robin fashion. 

**_DEISA_** python library implements a **_DEISA Adaptor_**. This component is used from the Dask client-side to create Dask arrays describing the data generated by the simulation. The **_DEISA Adaptor_** waits for an array descriptor to be sent from the **_DEISA Bridge_** in MPI rank 0. This descriptor is a dictionary with data names as keys and a dictionary containing the sizes, dimensions, and chunk sizes, as values. 
The **_DEISA Adaptor_** uses this information to create Dask arrays, that can be retrieved by calling `get_data()` method.    

# Example :
Am example on how this works is [here](https://github.com/GueroudjiAmal/deisa_example) 
